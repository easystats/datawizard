* using log directory 'C:/Users/etienne/Desktop/Divers/datawizard/revdep/checks/performance/new/performance.Rcheck'
* using R version 4.2.2 (2022-10-31 ucrt)
* using platform: x86_64-w64-mingw32 (64-bit)
* using session charset: UTF-8
* using options '--no-manual --no-build-vignettes'
* checking for file 'performance/DESCRIPTION' ... OK
* checking extension type ... Package
* this is package 'performance' version '0.10.2'
* package encoding: UTF-8
* checking package namespace information ... OK
* checking package dependencies ... OK
* checking if this is a source package ... OK
* checking if there is a namespace ... OK
* checking for executable files ... OK
* checking for hidden files and directories ... OK
* checking for portable file names ... OK
* checking whether package 'performance' can be installed ... OK
* checking installed package size ... OK
* checking package directory ... OK
* checking DESCRIPTION meta-information ... OK
* checking top-level files ... OK
* checking for left-over files ... OK
* checking index information ... OK
* checking package subdirectories ... OK
* checking R files for non-ASCII characters ... OK
* checking R files for syntax errors ... OK
* checking whether the package can be loaded ... OK
* checking whether the package can be loaded with stated dependencies ... OK
* checking whether the package can be unloaded cleanly ... OK
* checking whether the namespace can be loaded with stated dependencies ... OK
* checking whether the namespace can be unloaded cleanly ... OK
* checking loading without being on the library search path ... OK
* checking dependencies in R code ... OK
* checking S3 generic/method consistency ... OK
* checking replacement functions ... OK
* checking foreign function calls ... OK
* checking R code for possible problems ... OK
* checking Rd files ... OK
* checking Rd metadata ... OK
* checking Rd cross-references ... OK
* checking for missing documentation entries ... OK
* checking for code/documentation mismatches ... OK
* checking Rd \usage sections ... OK
* checking Rd contents ... OK
* checking for unstated dependencies in examples ... OK
* checking R/sysdata.rda ... OK
* checking examples ... ERROR
Running examples in 'performance-Ex.R' failed
The error most likely occurred in:

> ### Name: check_outliers
> ### Title: Outliers detection (check for influential observations)
> ### Aliases: check_outliers check_outliers.default check_outliers.numeric
> ###   check_outliers.data.frame
> 
> ### ** Examples
> 
> data <- mtcars # Size nrow(data) = 32
> 
> # For single variables ------------------------------------------------------
> outliers_list <- check_outliers(data$mpg) # Find outliers
> outliers_list # Show the row index of the outliers
[32mOK: No outliers detected.
- Based on the following method and threshold: zscore_robust (3.09).
- For variable: data$mpg

[39m> as.numeric(outliers_list) # The object is a binary vector...
 [1] 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
> filtered_data <- data[!outliers_list, ] # And can be used to filter a dataframe
> nrow(filtered_data) # New size, 28 (4 outliers removed)
[1] 32
> 
> # Find all observations beyond +/- 2 SD
> check_outliers(data$mpg, method = "zscore", threshold = 2)
[33m2 outliers detected: cases 18, 20.
- Based on the following method and threshold: zscore (2).
- For variable: data$mpg.
[39m
-----------------------------------------------------------------------------
Outliers per variable (zscore): 

$`data$mpg`
   Row Distance_Zscore
18  18        2.042389
20  20        2.291272

> 
> # For dataframes ------------------------------------------------------
> check_outliers(data) # It works the same way on dataframes
[32mOK: No outliers detected.
- Based on the following method and threshold: mahalanobis (31.26).
- For variables: mpg, cyl, disp, hp, drat, wt, qsec, vs, am, gear, carb

[39m> 
> # You can also use multiple methods at once
> outliers_list <- check_outliers(data, method = c(
+   "mahalanobis",
+   "iqr",
+   "zscore"
+ ))
> outliers_list
[33m1 outlier detected: case 31.
- Based on the following methods and thresholds: mahalanobis (3.09), iqr
  (1.7), zscore (31.26).
- For variables: mpg, cyl, disp, hp, drat, wt, qsec, vs, am, gear, carb.[39m[33m
Note: Outliers were classified as such by[39m [33mat least half of the selected methods. 
[39m
-----------------------------------------------------------------------------
The following observations were considered outliers for two or more variables 
by at least one of the selected methods: 

  Row n_Zscore n_IQR
1  31        1     2
> 
> # Using `as.data.frame()`, we can access more details!
> outliers_info <- as.data.frame(outliers_list)
> head(outliers_info)
  Row Distance_Zscore Outlier_Zscore Distance_IQR Outlier_IQR
1   1        1.189901              0    0.4208483           0
2   2        1.189901              0    0.2941176           0
3   3        1.224858              0    0.5882353           0
4   4        1.122152              0    0.5882353           0
5   5        1.043081              0    0.3915954           0
6   6        1.564608              0    0.6809025           0
  Distance_Mahalanobis Outlier_Mahalanobis Outlier
1             8.946673                   0       0
2             8.287933                   0       0
3             8.937150                   0       0
4             6.096726                   0       0
5             5.429061                   0       0
6             8.877558                   0       0
> outliers_info$Outlier # Including the probability of being an outlier
 [1] 0.0000000 0.0000000 0.0000000 0.0000000 0.0000000 0.0000000 0.0000000
 [8] 0.0000000 0.3333333 0.0000000 0.0000000 0.0000000 0.0000000 0.0000000
[15] 0.0000000 0.3333333 0.0000000 0.0000000 0.0000000 0.0000000 0.0000000
[22] 0.0000000 0.0000000 0.0000000 0.0000000 0.0000000 0.0000000 0.0000000
[29] 0.0000000 0.0000000 0.6666667 0.0000000
> 
> # And we can be more stringent in our outliers removal process
> filtered_data <- data[outliers_info$Outlier < 0.1, ]
> 
> # We can run the function stratified by groups using `{dplyr}` package:
> if (require("poorman")) {
+   iris %>%
+     group_by(Species) %>%
+     check_outliers()
+ }
Loading required package: poorman

  I'd seen my father. He was a poor man, and I watched him do astonishing things.
    - Sidney Poitier

Attaching package: 'poorman'

The following objects are masked from 'package:stats':

    filter, lag

Error in eval(expr, envir = data) : object 'info' not found
Calls: %>% ... .eval_expr -> .eval_call -> .select_context -> eval -> eval
Execution halted
* checking for unstated dependencies in 'tests' ... OK
* checking tests ... ERROR
  Running 'testthat.R'
Running the tests in 'tests/testthat.R' failed.
Last 13 lines of output:
  Backtrace:
      â–†
   1. â”œâ”€performance::check_outliers(iris2, method = c("zscore", "iqr")) at test-check_outliers.R:300:6
   2. â””â”€performance:::check_outliers.grouped_df(...)
   3.   â””â”€datawizard::data_relocate(...)
   4.     â””â”€datawizard:::.select_nse(...)
   5.       â””â”€datawizard:::.eval_expr(...)
   6.         â””â”€datawizard:::.eval_call(...)
   7.           â””â”€datawizard:::.select_context(x, data, ignore_case, regex, verbose)
   8.             â””â”€base::eval(expr, envir = data)
   9.               â””â”€base::eval(expr, envir = data)
  
  [ FAIL 1 | WARN 0 | SKIP 4 | PASS 236 ]
  Error: Test failures
  Execution halted
* DONE
Status: 2 ERRORs
