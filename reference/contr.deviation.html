<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Deviation Contrast Matrix — contr.deviation • datawizard</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Deviation Contrast Matrix — contr.deviation"><meta property="og:description" content="Build a deviation contrast matrix, a type of effects contrast matrix."><meta property="og:image" content="/logo.png"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">datawizard</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.11.0.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/selection_syntax.html">A quick summary of selection syntax in `{datawizard}`</a>
    </li>
    <li>
      <a href="../articles/standardize_data.html">Data Standardization</a>
    </li>
    <li>
      <a href="../articles/tidyverse_translation.html">Coming from 'tidyverse'</a>
    </li>
  </ul></li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/easystats/datawizard/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Deviation Contrast Matrix</h1>
    <small class="dont-index">Source: <a href="https://github.com/easystats/datawizard/blob/HEAD/R/contrs.R" class="external-link"><code>R/contrs.R</code></a></small>
    <div class="hidden name"><code>contr.deviation.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Build a deviation contrast matrix, a type of <em>effects contrast</em> matrix.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">contr.deviation</span><span class="op">(</span><span class="va">n</span>, base <span class="op">=</span> <span class="fl">1</span>, contrasts <span class="op">=</span> <span class="cn">TRUE</span>, sparse <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>n</dt>
<dd><p>a vector of levels for a factor, or the number of levels.</p></dd>


<dt>base</dt>
<dd><p>an integer specifying which group is considered the
    baseline group. Ignored if <code>contrasts</code> is <code>FALSE</code>.</p></dd>


<dt>contrasts</dt>
<dd><p>a logical indicating whether contrasts should be
    computed.</p></dd>


<dt>sparse</dt>
<dd><p>logical indicating if the result should be sparse
    (of class <code><a href="https://rdrr.io/pkg/Matrix/man/dgCMatrix-class.html" class="external-link">dgCMatrix</a></code>), using
    package <a href="https://CRAN.R-project.org/package=Matrix" class="external-link"><span class="pkg">Matrix</span></a>.</p></dd>

</dl></div>
    <div id="details">
    <h2>Details</h2>
    <p>In effects coding, unlike treatment/dummy coding
(<code><a href="https://rdrr.io/r/stats/contrast.html" class="external-link">stats::contr.treatment()</a></code>), each contrast sums to 0. In regressions models,
this results in an intercept that represents the (unweighted) average of the
group means. In ANOVA settings, this also guarantees that lower order effects
represent <em>main</em> effects (and not <em>simple</em> or <em>conditional</em> effects, as is
the case when using R's default <code><a href="https://rdrr.io/r/stats/contrast.html" class="external-link">stats::contr.treatment()</a></code>).
<br><br>
Deviation coding (<code>contr.deviation</code>) is a type of effects coding. With
deviation coding, the coefficients for factor variables are interpreted as
the difference of each factor level from the base level (this is the same
interpretation as with treatment/dummy coding). For example, for a factor
<code>group</code> with levels "A", "B", and "C", with <code>contr.devation</code>, the intercept
represents the overall mean (average of the group means for the 3 groups),
and the coefficients <code>groupB</code> and <code>groupC</code> represent the differences between
the A group mean and the B and C group means, respectively.
<br><br>
Sum coding (<code><a href="https://rdrr.io/r/stats/contrast.html" class="external-link">stats::contr.sum()</a></code>) is another type of effects coding. With sum
coding, the coefficients for factor variables are interpreted as the
difference of each factor level from <strong>the grand (across-groups) mean</strong>. For
example, for a factor <code>group</code> with levels "A", "B", and "C", with
<code>contr.sum</code>, the intercept represents the overall mean (average of the group
means for the 3 groups), and the coefficients <code>group1</code> and <code>group2</code> represent
the differences the
<strong>A</strong> and <strong>B</strong> group means from the overall mean, respectively.</p>
    </div>
    <div id="see-also">
    <h2>See also</h2>
    <div class="dont-index"><p><code><a href="https://rdrr.io/r/stats/contrast.html" class="external-link">stats::contr.sum()</a></code></p></div>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span> <span class="co"># !identical(Sys.getenv("IN_PKGDOWN"), "true")</span></span></span>
<span class="r-in"><span><span class="co"># \donttest{</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"mtcars"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">mtcars</span> <span class="op">&lt;-</span> <span class="fu"><a href="data_modify.html">data_modify</a></span><span class="op">(</span><span class="va">mtcars</span>, cyl <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">cyl</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">c.treatment</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span>Intercept <span class="op">=</span> <span class="fl">1</span>, <span class="fu"><a href="https://rdrr.io/r/stats/contrasts.html" class="external-link">contrasts</a></span><span class="op">(</span><span class="va">mtcars</span><span class="op">$</span><span class="va">cyl</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/solve.html" class="external-link">solve</a></span><span class="op">(</span><span class="va">c.treatment</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co">#&gt;            4 6 8</span></span></span>
<span class="r-in"><span><span class="co">#&gt; Intercept  1 0 0  # mean of the 1st level</span></span></span>
<span class="r-in"><span><span class="co">#&gt; 6         -1 1 0  # 2nd level - 1st level</span></span></span>
<span class="r-in"><span><span class="co">#&gt; 8         -1 0 1  # 3rd level - 1st level</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/stats/contrasts.html" class="external-link">contrasts</a></span><span class="op">(</span><span class="va">mtcars</span><span class="op">$</span><span class="va">cyl</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="va">contr.sum</span></span></span>
<span class="r-in"><span><span class="va">c.sum</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span>Intercept <span class="op">=</span> <span class="fl">1</span>, <span class="fu"><a href="https://rdrr.io/r/stats/contrasts.html" class="external-link">contrasts</a></span><span class="op">(</span><span class="va">mtcars</span><span class="op">$</span><span class="va">cyl</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/solve.html" class="external-link">solve</a></span><span class="op">(</span><span class="va">c.sum</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co">#&gt;                4      6      8</span></span></span>
<span class="r-in"><span><span class="co">#&gt; Intercept  0.333  0.333  0.333   # overall mean</span></span></span>
<span class="r-in"><span><span class="co">#&gt;            0.667 -0.333 -0.333   # deviation of 1st from overall mean</span></span></span>
<span class="r-in"><span><span class="co">#&gt;           -0.333  0.667 -0.333   # deviation of 2nd from overall mean</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/stats/contrasts.html" class="external-link">contrasts</a></span><span class="op">(</span><span class="va">mtcars</span><span class="op">$</span><span class="va">cyl</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="va">contr.deviation</span></span></span>
<span class="r-in"><span><span class="va">c.deviation</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span>Intercept <span class="op">=</span> <span class="fl">1</span>, <span class="fu"><a href="https://rdrr.io/r/stats/contrasts.html" class="external-link">contrasts</a></span><span class="op">(</span><span class="va">mtcars</span><span class="op">$</span><span class="va">cyl</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/solve.html" class="external-link">solve</a></span><span class="op">(</span><span class="va">c.deviation</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co">#&gt;                4     6     8</span></span></span>
<span class="r-in"><span><span class="co">#&gt; Intercept  0.333 0.333 0.333   # overall mean</span></span></span>
<span class="r-in"><span><span class="co">#&gt; 6         -1.000 1.000 0.000   # 2nd level - 1st level</span></span></span>
<span class="r-in"><span><span class="co">#&gt; 8         -1.000 0.000 1.000   # 3rd level - 1st level</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## With Interactions -----------------------------------------</span></span></span>
<span class="r-in"><span><span class="va">mtcars</span> <span class="op">&lt;-</span> <span class="fu"><a href="data_modify.html">data_modify</a></span><span class="op">(</span><span class="va">mtcars</span>, am <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/zC.html" class="external-link">C</a></span><span class="op">(</span><span class="va">am</span>, contr <span class="op">=</span> <span class="va">contr.deviation</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">mtcars</span> <span class="op">&lt;-</span> <span class="fu"><a href="data_arrange.html">data_arrange</a></span><span class="op">(</span><span class="va">mtcars</span>, select <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"cyl"</span>, <span class="st">"am"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">mm</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/model.matrix.html" class="external-link">model.matrix</a></span><span class="op">(</span><span class="op">~</span> <span class="va">cyl</span> <span class="op">*</span> <span class="va">am</span>, data <span class="op">=</span> <span class="va">mtcars</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">mm</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  <span class="st">"cyl4.am0"</span>, <span class="st">"cyl4.am1"</span>, <span class="st">"cyl6.am0"</span>,</span></span>
<span class="r-in"><span>  <span class="st">"cyl6.am1"</span>, <span class="st">"cyl8.am0"</span>, <span class="st">"cyl8.am1"</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/solve.html" class="external-link">solve</a></span><span class="op">(</span><span class="va">mm</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co">#&gt;             cyl4.am0 cyl4.am1 cyl6.am0 cyl6.am1 cyl8.am0 cyl8.am1</span></span></span>
<span class="r-in"><span><span class="co">#&gt; (Intercept)    0.167    0.167    0.167    0.167    0.167    0.167  # overall mean</span></span></span>
<span class="r-in"><span><span class="co">#&gt; cyl6          -0.500   -0.500    0.500    0.500    0.000    0.000  # cyl MAIN eff: 2nd - 1st</span></span></span>
<span class="r-in"><span><span class="co">#&gt; cyl8          -0.500   -0.500    0.000    0.000    0.500    0.500  # cyl MAIN eff: 2nd - 1st</span></span></span>
<span class="r-in"><span><span class="co">#&gt; am1           -0.333    0.333   -0.333    0.333   -0.333    0.333  # am MAIN eff</span></span></span>
<span class="r-in"><span><span class="co">#&gt; cyl6:am1       1.000   -1.000   -1.000    1.000    0.000    0.000</span></span></span>
<span class="r-in"><span><span class="co">#&gt; cyl8:am1       1.000   -1.000    0.000    0.000   -1.000    1.000</span></span></span>
<span class="r-in"><span><span class="co"># }</span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Indrajeet Patil, Etienne Bacher, Dominique Makowski, Daniel Lüdecke, Mattan S. Ben-Shachar, Brenton M. Wiernik.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.9.</p>
</div>

      </footer></div>

  


  

  </body></html>

